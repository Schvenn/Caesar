param([string]$s,[int]$sh=1,[string]$o,[switch]$u,[switch]$nh);$sc={param($c,$sh)$cd=[int][char]$c;if($cd-ge 65-and $cd-le 90){[char]((($cd-65+$sh+26)%26)+65)}elseif($cd-ge 97-and $cd-le 122){[char]((($cd-97+$sh+26)%26)+97)}else{$c}};$rs={param($l)$cs=([char[]](33..126|?{$_-notin 172,173,188,189,190}))-join '';-join(1..$l|%{$cs[(Get-Random -Maximum $cs.Length)]})};$t=(Test-Path $s)?(Get-Content $s -Raw):$s;$f=Test-Path $s;$fn=[IO.Path]::GetFileName($s);if($u){if($t-match"^çæšª®.{10}\d{3}(\d{2}).{10}([^\¼½¾µ°¬]{5,})(?=.{10}µ)"){$sh=-[int]$matches[1];$fn2=($matches[2].ToCharArray()|%{&$sc $_ $sh})-join'';$t=$t-replace"^çæšª®.{10}\d{3}\d{2}.{10}.+?µ",""}else{$t=$t-replace"^ç.+µ",'';$t=$t-replace"^.+µ",'';$sh=-$sh}};$t=$t-replace" ","~";$t=$t-replace"`r","°"-replace"`n","¬";$t=[regex]::Replace($t,"°¬°¬",{ "°¬"+("¼","½","¾"|Get-Random)+(&$rs (Get-Random -Minimum 40 -Maximum 1000))+"°¬" });$o2=($t.ToCharArray()|%{&$sc $_ $sh}) -join'';if($u){$o2=$o2-replace"°¬[¼½¾].+?°¬","°¬°¬";$o2=$o2-replace"~"," ";$o2=$o2-replace"°¬","`r`n"};if(-not $u-and -not $nh -and $f){$ss=$sh.ToString("00");$h="çæšª®"+(&$rs 10)+(Get-Random -Minimum 100 -Maximum 999).ToString()+$ss+(&$rs 10);$fn2=(($fn+".undo").ToCharArray()|%{&$sc $_ $sh}) -join'';$h+=$fn2+(&$rs 10)+"µ";$o2=$h+$o2};if($o){$fn2=$o};if($fn2){$o2.TrimEnd("`r","`n")|Out-File $fn2 -Encoding utf8 -NoNewline}